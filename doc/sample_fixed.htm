<html>
<script type='text/x-mathjax-config'>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath:  [ ['@(@','@)@'] ] ,
    displayMath: [ ['@[@','@]@'] ]
  }
});
</script>
<script type='text/javascript' src=
'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=default'
>
</script>
<head>
<title>Sample Posterior for Fixed Effects</title>
<meta http-equiv='Content-Type' content='text/html' charset='utf-8'>
<meta name="description" id="description" content="Sample Posterior for Fixed Effects">
<meta name="keywords" id="keywords" content=" sample posterior fixed effects syntax see also prototype public purpose constant constraints covariance manage_gsl_rng mixed_object information_rcv solution fixed_lower fixed_upper random_opt example other method ">
<style type='text/css'>
body { color : black }
body { background-color : white }
A:link { color : blue }
A:visited { color : purple }
A:active { color : purple }
</style>
<script type='text/javascript' language='JavaScript' src='_sample_fixed_htm.js'>
</script>
</head>
<body>
<table><tr>
<td>
<a href="https://github.com/bradbell/cppad_mixed" target="_top"><img border="0" src="_image.gif"></a>
</td>
<td><a href="hes_random_obj.cpp.htm" target="_top">Prev</a>
</td><td><a href="sample_fixed.cpp.htm" target="_top">Next</a>
</td><td>
<select onchange='choose_across0(this)'>
<option>Index-&gt;</option>
<option>contents</option>
<option>reference</option>
<option>index</option>
<option>search</option>
<option>external</option>
</select>
</td>
<td>
<select onchange='choose_up0(this)'>
<option>Up-&gt;</option>
<option>cppad_mixed</option>
<option>base_class</option>
<option>sample_fixed</option>
</select>
</td>
<td>
<script type='text/javascript' language='JavaScript' src='_childtable_cppad_mixed_htm.js'></script>
</td>
<td>
<script type='text/javascript' language='JavaScript' src='_childtable_base_class_htm.js'></script>
</td>
<td>
<script type='text/javascript' language='JavaScript' src='_childtable_sample_fixed_htm.js'></script>
</td>
</tr></table><br>
@(@\newcommand{\R}[1]{ {\rm #1} }
\newcommand{\B}[1]{ {\bf #1} }
\newcommand{\W}[1]{ \; #1 \; }@)@<center><b><big><big>Sample Posterior for Fixed Effects</big></big></b></center>

<br><a href="sample_fixed.htm#Syntax" target="_top">Syntax</a>
<br><a href="sample_fixed.htm#See Also" target="_top">See&nbsp;Also</a>
<br><a href="sample_fixed.htm#Prototype" target="_top">Prototype</a>
<br><a href="sample_fixed.htm#Public" target="_top">Public</a>
<br><a href="sample_fixed.htm#Purpose" target="_top">Purpose</a>
<br><a href="sample_fixed.htm#Constant Fixed Effects" target="_top">Constant&nbsp;Fixed&nbsp;Effects</a>
<br><a href="sample_fixed.htm#Constraints" target="_top">Constraints</a>
<br><a href="sample_fixed.htm#Covariance" target="_top">Covariance</a>
<br><a href="sample_fixed.htm#manage_gsl_rng" target="_top">manage_gsl_rng</a>
<br><a href="sample_fixed.htm#mixed_object" target="_top">mixed_object</a>
<br><a href="sample_fixed.htm#sample" target="_top">sample</a>
<br><a href="sample_fixed.htm#information_rcv" target="_top">information_rcv</a>
<br><a href="sample_fixed.htm#solution" target="_top">solution</a>
<br><a href="sample_fixed.htm#fixed_lower" target="_top">fixed_lower</a>
<br><a href="sample_fixed.htm#fixed_upper" target="_top">fixed_upper</a>
<br><a href="sample_fixed.htm#random_opt" target="_top">random_opt</a>
<br><a href="sample_fixed.htm#Example" target="_top">Example</a>
<br><a href="sample_fixed.htm#Other Method" target="_top">Other&nbsp;Method</a>
<br><br>
<b><big><a name="Syntax" id="Syntax">Syntax</a></big></b>

<br>

<code><i><font color="black"><span style='white-space: nowrap'>mixed_object</span></font></i><font color="blue"><span style='white-space: nowrap'>.sample_fixed(<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>sample</span></font></i><font color="blue"><span style='white-space: nowrap'>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>information_rcv</span></font></i><font color="blue"><span style='white-space: nowrap'>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>solution</span></font></i><font color="blue"><span style='white-space: nowrap'>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>fixed_lower</span></font></i><font color="blue"><span style='white-space: nowrap'>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>fixed_upper</span></font></i><font color="blue"><span style='white-space: nowrap'>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>random_opt</span></font></i><font color="blue"><span style='white-space: nowrap'><br>
)</span></font></code>


<br>
<br>
<b><big><a name="See Also" id="See Also">See Also</a></big></b>

<br>
<a href="sample_random.htm" target="_top"><span style='white-space: nowrap'>sample_random</span></a>


<br>
<br>
<b><big><a name="Prototype" id="Prototype">Prototype</a></big></b>

<pre><tt>
<font color="#009900">void</font> cppad_mixed<font color="#990000">::</font><b><font color="#000000">sample_fixed</font></b><font color="#990000">(</font>
     CppAD<font color="#990000">::</font>vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font>                 sample               <font color="#990000">,</font>
     <b><font color="#0000FF">const</font></b> d_sparse_rcv<font color="#990000">&amp;</font>                    information_rcv      <font color="#990000">,</font>
     <b><font color="#0000FF">const</font></b> CppAD<font color="#990000">::</font>mixed<font color="#990000">::</font>fixed_solution<font color="#990000">&amp;</font>    solution             <font color="#990000">,</font>
     <b><font color="#0000FF">const</font></b> CppAD<font color="#990000">::</font>vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font>           fixed_lower          <font color="#990000">,</font>
     <b><font color="#0000FF">const</font></b> CppAD<font color="#990000">::</font>vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font>           fixed_upper          <font color="#990000">,</font>
     <b><font color="#0000FF">const</font></b> CppAD<font color="#990000">::</font>vector<font color="#990000">&lt;</font><font color="#009900">double</font><font color="#990000">&gt;&amp;</font>           random_opt           <font color="#990000">)</font></tt></pre>
<br>
<b><big><a name="Public" id="Public">Public</a></big></b>
<br>
This <code><font color="blue">cppad_mixed</font></code> <a href="base_class.htm" target="_top"><span style='white-space: nowrap'>base_class</span></a>
 member function is public.

<br>
<br>
<b><big><a name="Purpose" id="Purpose">Purpose</a></big></b>
<br>
This routine draws independent samples from
the asymptotic posterior distribution for the
fixed effects (given the model and the data).

<br>
<br>
<b><big><a name="Constant Fixed Effects" id="Constant Fixed Effects">Constant Fixed Effects</a></big></b>
<br>
If the upper and lower limits for a fixed effect are equal,

<code><font color="blue"><span style='white-space: nowrap'><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>fixed_lower</span></font></i><font color="blue"><span style='white-space: nowrap'>[</span></font><i><font color="black"><span style='white-space: nowrap'>j</span></font></i><font color="blue"><span style='white-space: nowrap'>]&nbsp;==&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>fixed_upper</span></font></i><font color="blue"><span style='white-space: nowrap'>[</span></font><i><font color="black"><span style='white-space: nowrap'>j</span></font></i><font color="blue"><span style='white-space: nowrap'>]<br>
</span></font></code>
we refer to the <code><i>j</i></code>-th fixed effect as constant.

<br>
<br>
<b><big><a name="Constraints" id="Constraints">Constraints</a></big></b>
<br>
Only the constant fixed effect constants are taken into account.
(This is an over estimate of the variance, but is faster to calculate
than trying to identify active constraints and treating them as equality
constraints.)
It can result in samples that are outside the limits
for the fixed effects that are not constant.
You may want to adjust the samples to be within
their upper and lower limits before you use them.

<br>
<br>
<b><big><a name="Covariance" id="Covariance">Covariance</a></big></b>
<br>
Each sample of the fixed effects
(excluding the constant fixed effects)
has covariance equal to the inverse of the
<a href="information_mat.htm" target="_top"><span style='white-space: nowrap'>information&nbsp;matrix</span></a>

(where the constant fixed effects have been removed).

<br>
<br>
<b><big><a name="manage_gsl_rng" id="manage_gsl_rng">manage_gsl_rng</a></big></b>
<br>
It is assumed that
<a href="manage_gsl_rng.htm#get_gsl_rng" target="_top"><span style='white-space: nowrap'>get_gsl_rng</span></a>
 will return
a pointer to a GSL random number generator.

<br>
<br>
<b><big><a name="mixed_object" id="mixed_object">mixed_object</a></big></b>
<br>
We use <a href="derived_ctor.htm#mixed_object" target="_top"><span style='white-space: nowrap'>mixed_object</span></a>

to denote an object of a class that is
derived from the <code><font color="blue">cppad_mixed</font></code> base class.

<br>
<br>
<b><big><a name="sample" id="sample">sample</a></big></b>
<br>
The size 
<code><i><font color="black"><span style='white-space: nowrap'>sample</span></font></i><font color="blue"><span style='white-space: nowrap'>.size()</span></font></code>
 is a multiple of
<a href="derived_ctor.htm#n_fixed" target="_top"><span style='white-space: nowrap'>n_fixed</span></a>
.
The input value of its elements does not matter.
We define

<code><font color="blue"><span style='white-space: nowrap'><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>n_sample</span></font></i><font color="blue"><span style='white-space: nowrap'>&nbsp;=&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>sample_size</span></font></i><font color="blue"><span style='white-space: nowrap'>&nbsp;/&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>n_fixed</span></font></i><font color="blue"><span style='white-space: nowrap'><br>
</span></font></code>
Upon return,
for 
<code><font color="blue"><span style='white-space: nowrap'>i</span></font><i><font color="black"><span style='white-space: nowrap'>&nbsp;=&nbsp;0&nbsp;,&nbsp;</span></font></i><font color="blue"><span style='white-space: nowrap'>...</span></font><i><font color="black"><span style='white-space: nowrap'>,&nbsp;</span></font></i><font color="blue"><span style='white-space: nowrap'>n_sample</span></font><i><font color="black"><span style='white-space: nowrap'>-1</span></font></i></code>
,

<code><font color="blue"><span style='white-space: nowrap'>j</span></font><i><font color="black"><span style='white-space: nowrap'>&nbsp;=&nbsp;0&nbsp;,&nbsp;</span></font></i><font color="blue"><span style='white-space: nowrap'>...</span></font><i><font color="black"><span style='white-space: nowrap'>,&nbsp;</span></font></i><font color="blue"><span style='white-space: nowrap'>n_fixed</span></font><i><font color="black"><span style='white-space: nowrap'>-1</span></font></i></code>
,

<code><font color="blue"><span style='white-space: nowrap'><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>sample</span></font></i><font color="blue"><span style='white-space: nowrap'>[&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>i</span></font></i><font color="blue"><span style='white-space: nowrap'>&nbsp;*&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>n_fixed</span></font></i><font color="blue"><span style='white-space: nowrap'>&nbsp;+&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>j</span></font></i><font color="blue"><span style='white-space: nowrap'>&nbsp;]<br>
</span></font></code>
is the <code><i>j</i></code>-th component of the <code><i>i</i></code>-th sample of the
optimal fixed effects <small>@(@
\hat{\theta}
@)@</small>.
These samples are independent for different <small>@(@
i
@)@</small>,
and for fixed <small>@(@
i
@)@</small>, they have the specified
<a href="sample_fixed.htm#Covariance" target="_top"><span style='white-space: nowrap'>covariance</span></a>
.

<br>
<br>
<b><big><a name="information_rcv" id="information_rcv">information_rcv</a></big></b>
<br>
This is a sparse matrix representation for the
lower triangle of the observed information matrix corresponding to

<code><i><font color="black"><span style='white-space: nowrap'>solution</span></font></i></code>
; i.e., the matrix returned by

<code><font color="blue"><span style='white-space: nowrap'><br>
</span></font><i><font color="black"><span style='white-space: nowrap'>information_rcv</span></font></i><font color="blue"><span style='white-space: nowrap'>&nbsp;=&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>mixed_object</span></font></i><font color="blue"><span style='white-space: nowrap'>.information_mat(<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>solution</span></font></i><font color="blue"><span style='white-space: nowrap'>,&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>random_options</span></font></i><font color="blue"><span style='white-space: nowrap'>,&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>random_lower</span></font></i><font color="blue"><span style='white-space: nowrap'>,&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>random_upper</span></font></i><font color="blue"><span style='white-space: nowrap'>,&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>random_in</span></font></i><font color="blue"><span style='white-space: nowrap'><br>
)</span></font></code>


<br>
<br>
<b><big><a name="solution" id="solution">solution</a></big></b>
<br>
is the <a href="optimize_fixed.htm#solution" target="_top"><span style='white-space: nowrap'>solution</span></a>

for a the call to <a href="optimize_fixed.htm" target="_top"><span style='white-space: nowrap'>optimize_fixed</span></a>
 corresponding to

<code><i><font color="black"><span style='white-space: nowrap'>information_rcv</span></font></i></code>
.
The only necessary information in this structure is

<code><i><font color="black"><span style='white-space: nowrap'>solution</span></font></i><font color="blue"><span style='white-space: nowrap'>.fixed_opt</span></font></code>
.

<br>
<br>
<b><big><a name="fixed_lower" id="fixed_lower">fixed_lower</a></big></b>
<br>
is the same as
<a href="optimize_fixed.htm#fixed_lower" target="_top"><span style='white-space: nowrap'>fixed_lower</span></a>

in the call to <code><font color="blue">optimize_fixed</font></code> that corresponding to 
<code><i><font color="black"><span style='white-space: nowrap'>solution</span></font></i></code>
.

<br>
<br>
<b><big><a name="fixed_upper" id="fixed_upper">fixed_upper</a></big></b>
<br>
is the same as
<a href="optimize_fixed.htm#fixed_upper" target="_top"><span style='white-space: nowrap'>fixed_upper</span></a>

in the call to <code><font color="blue">optimize_fixed</font></code> that corresponding to 
<code><i><font color="black"><span style='white-space: nowrap'>solution</span></font></i></code>
.

<br>
<br>
<b><big><a name="random_opt" id="random_opt">random_opt</a></big></b>
<br>
is the optimal random effects corresponding to the solution; i.e.

<code><font color="blue"><span style='white-space: nowrap'><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>random_opt</span></font></i><font color="blue"><span style='white-space: nowrap'>&nbsp;=&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>mixed_object</span></font></i><font color="blue"><span style='white-space: nowrap'>.optimize_random(<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>random_options</span></font></i><font color="blue"><span style='white-space: nowrap'>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>solution</span></font></i><font color="blue"><span style='white-space: nowrap'>.fixed_opt,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>random_lower</span></font></i><font color="blue"><span style='white-space: nowrap'>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>random_upper</span></font></i><font color="blue"><span style='white-space: nowrap'>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>random_in</span></font></i><font color="blue"><span style='white-space: nowrap'><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>
</span></font></code>

<code><i><font color="black"><span style='white-space: nowrap'>random_options</span></font></i></code>
,

<code><i><font color="black"><span style='white-space: nowrap'>random_lower</span></font></i></code>
,

<code><i><font color="black"><span style='white-space: nowrap'>random_upper</span></font></i></code>
, and

<code><i><font color="black"><span style='white-space: nowrap'>random_in</span></font></i></code>
, are the same
as in the call to <code><font color="blue">optimize_fixed</font></code> that corresponds to 
<code><i><font color="black"><span style='white-space: nowrap'>solution</span></font></i></code>
.


<br>
<br>
<b><big><a name="Example" id="Example">Example</a></big></b>
<br>
The file <a href="sample_fixed.cpp.htm" target="_top"><span style='white-space: nowrap'>sample_fixed.cpp</span></a>
 is an example
and test of <code><font color="blue">sample_fixed</font></code>.

<br>
<br>
<b><big><a name="Other Method" id="Other Method">Other Method</a></big></b>
<br>
The routine <a href="sample_conditional.htm" target="_top"><span style='white-space: nowrap'>sample_conditional</span></a>
, is a old method that is no
longer used for computing these samples.


<hr>Input File: src/sample_fixed.cpp

</body>
</html>
