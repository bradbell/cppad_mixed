<html>
<script type='text/x-mathjax-config'>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath:  [ ['@(@','@)@'] ] ,
    displayMath: [ ['@[@','@]@'] ]
  }
});
</script>
<script type='text/javascript' src=
'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=default'
>
</script>
<head>
<title>Changes and Additions to cppad_mixed During 2018</title>
<meta http-equiv='Content-Type' content='text/html' charset='utf-8'>
<meta name="description" id="description" content="Changes and Additions to cppad_mixed During 2018">
<meta name="keywords" id="keywords" content=" changes additions to cppad_mixed during 2018 09-25 08-30 08-27 08-22 08-20 08-18 08-09 08-08 07-25 07-12 06-30 06-29 06-20 06-14 06-09 06-04 05-21 05-07 05-03 04-06 03-22 03-10 02-20 02-12 02-11 02-10 02-08 02-07 02-05 01-23 01-22 01-21 01-15 01-14 ">
<style type='text/css'>
body { color : black }
body { background-color : white }
A:link { color : blue }
A:visited { color : purple }
A:active { color : purple }
</style>
<script type='text/javascript' language='JavaScript' src='_whats_new_18_htm.js'>
</script>
</head>
<body>
<table><tr>
<td>
<a href="https://github.com/bradbell/cppad_mixed" target="_top"><img border="0" src="_image.gif"></a>
</td>
<td><a href="opt_ran_nan.cpp.htm" target="_top">Prev</a>
</td><td><a href="whats_new_17.htm" target="_top">Next</a>
</td><td>
<select onchange='choose_across0(this)'>
<option>Index-&gt;</option>
<option>contents</option>
<option>reference</option>
<option>index</option>
<option>search</option>
<option>external</option>
</select>
</td>
<td>
<select onchange='choose_up0(this)'>
<option>Up-&gt;</option>
<option>cppad_mixed</option>
<option>whats_new_18</option>
</select>
</td>
<td>
<select onchange='choose_down1(this)'>
<option>cppad_mixed-&gt;</option>
<option>install_unix</option>
<option>theory</option>
<option>base_class</option>
<option>namespace</option>
<option>user</option>
<option>whats_new_18</option>
<option>wish_list</option>
<option>math_notation</option>
</select>
</td>
<td>
<select onchange='choose_down0(this)'>
<option>whats_new_18-&gt;</option>
<option>whats_new_17</option>
<option>whats_new_16</option>
<option>whats_new_15</option>
</select>
</td>
<td>
<select onchange='choose_current0(this)'>
<option>Headings-&gt;</option>
<option>Contents</option>
<option>09-25</option>
<option>08-30</option>
<option>08-27</option>
<option>08-22</option>
<option>08-20</option>
<option>08-18</option>
<option>08-09</option>
<option>08-08</option>
<option>07-25</option>
<option>07-12</option>
<option>06-30</option>
<option>06-29</option>
<option>06-20</option>
<option>06-14</option>
<option>06-09</option>
<option>06-04</option>
<option>05-21</option>
<option>05-07</option>
<option>05-03</option>
<option>04-06</option>
<option>03-22</option>
<option>03-10</option>
<option>02-20</option>
<option>02-12</option>
<option>02-11</option>
<option>02-10</option>
<option>02-08</option>
<option>02-07</option>
<option>02-05</option>
<option>01-23</option>
<option>01-22</option>
<option>01-21</option>
<option>01-15</option>
<option>01-14</option>
</select>
</td>
</tr></table><br>
@(@\newcommand{\R}[1]{ {\rm #1} }
\newcommand{\B}[1]{ {\bf #1} }
\newcommand{\W}[1]{ \; #1 \; }@)@<center><b><big><big>Changes and Additions to cppad_mixed During 2018</big></big></b></center>
<br>
<b><big><a name="Contents" id="Contents">Contents</a></big></b>
<br>
<table>
<tr><td><a href="whats_new_17.htm" target="_top">whats_new_17</a></td><td>Changes&nbsp;and&nbsp;Additions&nbsp;to&nbsp;cppad_mixed&nbsp;During&nbsp;2017</td></tr><tr><td><a href="whats_new_16.htm" target="_top">whats_new_16</a></td><td>Changes&nbsp;and&nbsp;Additions&nbsp;to&nbsp;cppad_mixed&nbsp;During&nbsp;2016</td></tr><tr><td><a href="whats_new_15.htm" target="_top">whats_new_15</a></td><td>Changes&nbsp;and&nbsp;Additions&nbsp;to&nbsp;cppad_mixed&nbsp;During&nbsp;2015</td></tr></table><br>
<b><big><a name="09-25" id="09-25">09-25</a></big></b>
<br>
Advance to <code><font color="blue">cppad-20180925</font></code>.
This enabled us to remove the need for two and three levels of AD; i.e.
<code><font color="blue">a2_double</font></code> and <code><font color="blue">a3_double</font></code>.
The arguments and results for the <a href="ran_likelihood.htm" target="_top"><span style='white-space: nowrap'>ran_likelihood</span></a>
 function
are now <a href="typedef.htm#Vector Types.a1_vector" target="_top"><span style='white-space: nowrap'>a1_vector</span></a>
 objects instead of
<code><font color="blue">a3_vector</font></code> objects.

<br>
<br>
<b><big><a name="08-30" id="08-30">08-30</a></big></b>

<b><br>
API:</b>
Remove the user defined versions of the Jacobian and Hessian
of the random likelihood with respect to the random effects;
<code><font color="blue">ran_likelihood_jac</font></code> and <code><font color="blue">ran_likelihood_hes</font></code>.
These functions are no longer part of the API and are not used
(even if defined by the user).

<br>
<br>
<b><big><a name="08-27" id="08-27">08-27</a></big></b>
<br>
Advance to <code><font color="blue">cppad-20180827</font></code>

<br>
<br>
<b><big><a name="08-22" id="08-22">08-22</a></big></b>

<b><br>
API:</b>
Change the type <code><font color="blue">CppAD::mixed::sparse_rcv</font></code> to
<a href="typedef.htm#Sparse Types.d_sparse_rcv" target="_top"><span style='white-space: nowrap'>d_sparse_rcv</span></a>

to better be more consistent with the other
CppAD mixed <a href="typedef.htm" target="_top"><span style='white-space: nowrap'>type&nbsp;definitions</span></a>
.
This will require some minor changes to the user's code.
For example,
in the constructor for the derived class,
the type for <a href="derived_ctor.htm" target="_top"><span style='white-space: nowrap'>A_rcv</span></a>
 has changed from
<code><font color="blue">sparse_rcv</font></code> to <code><font color="blue">d_sparse_rcv</font></code>.

<br>
<br>
<b><big><a name="08-20" id="08-20">08-20</a></big></b>
<br>
Advance to <code><font color="blue">cppad-20180820</font></code>
(this version has optimization of dynamic parameters).

<br>
<br>
<b><big><a name="08-18" id="08-18">08-18</a></big></b>

<ol type="1"><li>
Advance to <code><font color="blue">cppad-20810818</font></code>.
</li><li>

Use Cppad dynamic parameters (new feature) to speed up the computation
of the Hessian of the objective
(when <a href="derived_ctor.htm#quasi_fixed" target="_top"><span style='white-space: nowrap'>quasi_fixed</span></a>
 is true).
Cppad needs to improve its optimization of dynamic parameter calculations.
For example, the optimized tapes that compute the Hessian of
<a href="theory.htm#Approximate Laplace Objective, H(beta, theta, u)" target="_top"><span style='white-space: nowrap'>H(beta,&nbsp;theta,&nbsp;u)</span></a>

are larger when 
<code><i><font color="black"><span style='white-space: nowrap'>(theta,&nbsp;u)</span></font></i></code>
 are dynamic parameters
than when they are variables.
These tapes are about the same size before being optimized.
</li></ol>



<br>
<br>
<b><big><a name="08-09" id="08-09">08-09</a></big></b>
<br>
Advance to <code><font color="blue">cppad-20810809</font></code>.
This fixed valgrind warnings and a bug in cppad.

<br>
<br>
<b><big><a name="08-08" id="08-08">08-08</a></big></b>
<br>
Advance to <code><font color="blue">cppad-20810730</font></code>.
This resulted is and speed improvement for the current version of the
<a href="ar1_xam.sh.htm" target="_top"><span style='white-space: nowrap'>ar1_xam.sh</span></a>
 and <a href="capture_xam.sh.htm" target="_top"><span style='white-space: nowrap'>capture_xam.sh</span></a>
 tests.

<br>
<br>
<b><big><a name="07-25" id="07-25">07-25</a></big></b>

<ol type="1"><li>
Add discussion of whey the default
<a href="run_cmake.sh.htm#eigen_prefix" target="_top"><span style='white-space: nowrap'>eigen_prefix</span></a>
 is different
from the other prefixes.
</li><li>

Change the name <code><font color="blue">cppad_cxx_flags</font></code> to
<a href="run_cmake.sh.htm#extra_cxx_flags" target="_top"><span style='white-space: nowrap'>extra_cxx_flags</span></a>
.
</li><li>

Improve discussion of the
<a href="install_unix.htm#Paths" target="_top"><span style='white-space: nowrap'>paths</span></a>
 needed during and after the install process.
</li><li>

Improve detection
(during the <a href="install_unix.htm" target="_top"><span style='white-space: nowrap'>install</span></a>
)
of when the default settings for
<a href="run_cmake.sh.htm#extra_cxx_flags" target="_top"><span style='white-space: nowrap'>extra_cxx_flags</span></a>
 do not work.
</li></ol>



<br>
<br>
<b><big><a name="07-12" id="07-12">07-12</a></big></b>

<ol type="1"><li>
The fixed effects optimization will not try to backup and recover when
<a href="optimize_fixed.htm#fixed_ipopt_options.max_iter" target="_top"><span style='white-space: nowrap'>max_iter</span></a>
 is minus
one for the fixed effects.
In addition, when running the debug (release) version, errors during
<a href="initialize.htm" target="_top"><span style='white-space: nowrap'>initialize</span></a>
 will result in an runtime error
(call to <a href="public.htm#User Defined Functions.fatal_error" target="_top"><span style='white-space: nowrap'>fatal_error</span></a>
).
This will gives the user the choice to seem the source code where
the error was detected when
<a href="run_cmake.sh.htm#build_type" target="_top"><span style='white-space: nowrap'>build_type</span></a>
 is <code><font color="blue">debug</font></code>.
</li><li>

Improve documentation for
<a href="derived_ctor.htm#quasi_fixed" target="_top"><span style='white-space: nowrap'>quasi_fixed</span></a>
.
</li></ol>


<br>
<br>
<b><big><a name="06-30" id="06-30">06-30</a></big></b>

<ol type="1"><li>
Implement the partial Newton step update in definition of
the second order accurate approximation for the optimal random effects
<a href="theory.htm#Approximate Optimal Random Effects.Second Order, W(beta, theta, u)" target="_top"><span style='white-space: nowrap'>W(beta,&nbsp;theta,&nbsp;u)</span></a>
.
This should lead to a large improvement when the Hessian of the
random likelihood with respect to the random effects is sparse.
</li><li>

The <code><font color="blue">checkpoint_newton_step</font></code> setting in
<a href="run_cmake.sh.htm" target="_top"><span style='white-space: nowrap'>run_cmake.sh</span></a>
 has been removed.
</li></ol>



<br>
<br>
<b><big><a name="06-29" id="06-29">06-29</a></big></b>
<br>
Advance to <code><font color="blue">cppad-20180627</font></code>.

<br>
<br>
<b><big><a name="06-20" id="06-20">06-20</a></big></b>
<br>
Advance to <code><font color="blue">cppad-20180620</font></code>.
This should use increase speed and use less memory during the
optimization of cppad functions; see
<a href="run_cmake.sh.htm#optimize_cppad_function" target="_top"><span style='white-space: nowrap'>optimize_cppad_function</span></a>
.

<br>
<br>
<b><big><a name="06-14" id="06-14">06-14</a></big></b>

<ol type="1"><li>
Some systems installs of
<a href="install_unix.htm#System Requirements.suitesparse" target="_top"><span style='white-space: nowrap'>suitesparse</span></a>

install <code><font color="blue">cholmod.h</font></code> in the systems include path instead of
a <code><font color="blue">suitesparse</font></code> subdirector of the system include path.
The install of <code><font color="blue">cppad_mixed</font></code> now automatically detects both these cases.
</li><li>

Advance to <code><font color="blue">cppad-20180613</font></code>.
This should use less memory during the optimization of cppad functions; see
<a href="run_cmake.sh.htm#optimize_cppad_function" target="_top"><span style='white-space: nowrap'>optimize_cppad_function</span></a>
.
</li></ol>


<br>
<br>
<b><big><a name="06-09" id="06-09">06-09</a></big></b>

<ol type="1"><li>
Change the <code><font color="blue">suitesparse</font></code> library from a special requirement
(using <code><font color="blue">bin/install_suitesparse.sh</font></code>) to a
<a href="install_unix.htm#System Requirements.suitesparse" target="_top"><span style='white-space: nowrap'>system&nbsp;requirement</span></a>
.
</li><li>

The <code><font color="blue">replace</font></code> option for the
<a href="example_install.sh.htm#existing" target="_top"><span style='white-space: nowrap'>existing</span></a>
 argument to
<code><font color="blue">bin/example_install.sh</font></code> was not working.
This has been fixed.
</li></ol>


<br>
<br>
<b><big><a name="06-04" id="06-04">06-04</a></big></b>
<br>
Advance to using
<a href="install_unix.htm#Special Requirements.CppAD" target="_top"><span style='white-space: nowrap'>cppad-20180604</span></a>
.
This will probably have no effect but might reduce the amount of memory
<code><font color="blue">cppad_mixed</font></code> uses.

<br>
<br>
<b><big><a name="05-21" id="05-21">05-21</a></big></b>
<br>
Advance to using
<a href="install_unix.htm#Special Requirements.CppAD" target="_top"><span style='white-space: nowrap'>cppad-20180521</span></a>
.
This should reduce the amount of memory
<code><font color="blue">cppad_mixed</font></code> uses.

<br>
<br>
<b><big><a name="05-07" id="05-07">05-07</a></big></b>
<br>
Advance to using
<a href="install_unix.htm#Special Requirements.CppAD" target="_top"><span style='white-space: nowrap'>cppad-20180507</span></a>
.
This should both increase the speed of <code><font color="blue">cppad_mixed</font></code>
and reduce the amount of memory it uses.

<br>
<br>
<b><big><a name="05-03" id="05-03">05-03</a></big></b>
<br>
Advance to using
<a href="install_unix.htm#Special Requirements.CppAD" target="_top"><span style='white-space: nowrap'>cppad-20180503</span></a>
.
This should reduce the amount of memory used by <code><font color="blue">cppad_mixed</font></code>,
without adversely affecting its speed.

<br>
<br>
<b><big><a name="04-06" id="04-06">04-06</a></big></b>
<br>
The <code><font color="blue">limited_memory_max_history</font></code> setting used to be forbidden as an
<a href="optimize_fixed.htm#fixed_ipopt_options" target="_top"><span style='white-space: nowrap'>fixed_ipopt_option</span></a>
 because
it was chosen by <code><font color="blue">cppad_mixed</font></code>.
This has been changed and now the user can choose this ipopt option.

<br>
<br>
<b><big><a name="03-22" id="03-22">03-22</a></big></b>
<br>
In the wish list,
remove the Student's t item and change the
<a href="wish_list.htm#Sparse Matrix" target="_top"><span style='white-space: nowrap'>sparse&nbsp;matrix</span></a>
 item.

<br>
<br>
<b><big><a name="03-10" id="03-10">03-10</a></big></b>
<br>
The install <a href="install_unix.htm#Download" target="_top"><span style='white-space: nowrap'>download</span></a>
 procedure was changed
to use the following command to determine the version number:
<code><font color='blue'><pre style='display:inline'> 
     grep '^SET(cppad_mixed_version' CMakeLists.txt
</pre></font></code>
<br>
<b><big><a name="02-20" id="02-20">02-20</a></big></b>
<br>
Some function declarations for friends in <code><font color="blue">cppad_mixed.hpp</font></code>
were missing. This has been fixed.

<br>
<br>
<b><big><a name="02-12" id="02-12">02-12</a></big></b>
<br>
Add more discussion of
<a href="optimize_fixed.htm#fixed_scale" target="_top"><span style='white-space: nowrap'>fixed_scale</span></a>
.

<br>
<br>
<b><big><a name="02-11" id="02-11">02-11</a></big></b>
<br>
Avoid warning: 'obj_factor_scaled' may be used uninitialized in eval_h
on some systems.

<br>
<br>
<b><big><a name="02-10" id="02-10">02-10</a></big></b>

<ol type="1"><li>
The <code><font color="blue">hide_ipopt_scaling</font></code> option was removed from the
<a href="run_cmake.sh.htm" target="_top"><span style='white-space: nowrap'>cmake&nbsp;command</span></a>
 and the scaling is always
hidden from ipopt.
</li><li>

Improve discussion of the <a href="optimize_fixed.htm#fixed_scale" target="_top"><span style='white-space: nowrap'>fixed_scale</span></a>

argument to the <code><font color="blue">optimize_fixed</font></code> function.
</li></ol>


<br>
<br>
<b><big><a name="02-08" id="02-08">02-08</a></big></b>
<br>
There was a bug in computing the second derivative of the objective when the
<a href="fix_likelihood.htm" target="_top"><span style='white-space: nowrap'>fix_likelihood</span></a>
 had absolute value terms in its
<a href="cppad_mixed.htm#Negative Log-Density Vector" target="_top"><span style='white-space: nowrap'>negative&nbsp;log-density&nbsp;vector</span></a>
.
This has been fixed.

<br>
<br>
<b><big><a name="02-07" id="02-07">02-07</a></big></b>

<ol type="1"><li>
Change the <code><font color="blue">adaptive</font></code> and <code><font color="blue">trace-adaptive</font></code>
<a href="optimize_fixed.htm#fixed_ipopt_options.derivative_test" target="_top"><span style='white-space: nowrap'>derivative_test</span></a>

options so they check that components of the Jacobian, evaluated by
<a href="ipopt_fixed_eval_jac_g.htm" target="_top"><span style='white-space: nowrap'>eval_jac_g</span></a>
,
that are not in the sparsity pattern, are zero.
</li><li>

Change adaptive derivative check to test Hessian evaluated by
<a href="ipopt_fixed_eval_h.htm" target="_top"><span style='white-space: nowrap'>eval_h</span></a>
,
when <a href="derived_ctor.htm#quasi_fixed" target="_top"><span style='white-space: nowrap'>quasi_fixed</span></a>
 is false.
</li><li>

Change the ipopt <code><font color="blue">eval_h</font></code> documentation to specify either
upper or lower triangle; e.g., see
<a href="ipopt_xam_eval_h.htm#iRow" target="_top"><span style='white-space: nowrap'>iRow</span></a>
.
</li></ol>


<br>
<br>
<b><big><a name="02-05" id="02-05">02-05</a></big></b>

<ol type="1"><li>
The scaling of the fixed effects optimization has been
changed to not include components of the fixed effects for which
the lower and upper limits are equal; see
<a href="optimize_fixed.htm#fixed_scale" target="_top"><span style='white-space: nowrap'>fixed_scale</span></a>
.
</li><li>

Reduce the changes of a random failure (false negative result)
during the testing of <a href="lasso.cpp.htm" target="_top"><span style='white-space: nowrap'>lasso.cpp</span></a>
.
</li></ol>


<br>
<br>
<b><big><a name="01-23" id="01-23">01-23</a></big></b>
<br>
There was a mistake in the removal of 
<code><i><font color="black"><span style='white-space: nowrap'>use_atomic_cholesky</span></font></i></code>
;
see 01-21 below.  This has been fixed.

<br>
<br>
<b><big><a name="01-22" id="01-22">01-22</a></big></b>
<br>
Improve the instructions for combining both
<a href="run_cmake.sh.htm#Debug and Release" target="_top"><span style='white-space: nowrap'>debug&nbsp;and&nbsp;release</span></a>

versions of cppad_mixed on the same system.

<br>
<br>
<b><big><a name="01-21" id="01-21">01-21</a></big></b>
<br>
Remove the 
<code><i><font color="black"><span style='white-space: nowrap'>use_atomic_cholesky</span></font></i></code>
 option from the
<a href="run_cmake.sh.htm" target="_top"><span style='white-space: nowrap'>cmake</span></a>
 script.

<br>
<br>
<b><big><a name="01-15" id="01-15">01-15</a></big></b>
<br>
The flags <code><font color="blue">-Wpedantic</font></code>, <code><font color="blue">-Wshadow</font></code> and <code><font color="blue">-Wconversion</font></code>
were added to the default value of
<a href="run_cmake.sh.htm#extra_cxx_flags" target="_top"><span style='white-space: nowrap'>extra_cxx_flags</span></a>
.
In addition, fix the corresponding warning messages generated by gcc
during the
<a href="install_unix.htm#cppad_mixed" target="_top"><span style='white-space: nowrap'>cppad_mixed</span></a>
 part of the instal process.

<br>
<br>
<b><big><a name="01-14" id="01-14">01-14</a></big></b>
<br>
Change the <code><font color="blue">ran_likelihood_hes.cpp</font></code> example to use the
offset log normal distribution and eliminate the chance of random failure
during its test.


<hr>Input File: omh/whats_new/18.omh

</body>
</html>
