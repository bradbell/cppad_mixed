.. include:: xrst_preamble.rst

.. _derived_ctor-name:

!!!!!!!!!!!!
derived_ctor
!!!!!!!!!!!!

xrst input file: ``src/derived_ctor.cpp``

.. meta::
   :keywords: derived_ctor, user, defined, class, derived, from, cppad_mixed

.. index:: derived_ctor, user, defined, class, derived, from, cppad_mixed

.. _derived_ctor-title:

User Defined Class Derived From cppad_mixed
###########################################

.. meta::
   :keywords: syntax

.. index:: syntax

.. _derived_ctor@Syntax:

Syntax
******

| *mixed_derived* *mixed_object* (
| |tab| *n_fixed* , *n_random* ,
| |tab| *quasi_fixed* , *bool_sparsity* , *A_rcv* , *trace_init* ,
| |tab| ...
| )

.. meta::
   :keywords: prototype

.. index:: prototype

.. _derived_ctor@Prototype:

Prototype
*********

.. literalinclude:: ../../include/cppad/mixed/base_class.hpp
   :lines: 118-125
   :language: cpp

.. meta::
   :keywords: see, also

.. index:: see, also

.. _derived_ctor@See Also:

See Also
********
:ref:`initialize-name`

.. meta::
   :keywords: mixed_derived

.. index:: mixed_derived

.. _derived_ctor@mixed_derived:

mixed_derived
*************
This is the name of the class derived in the following fashion:

   ``class`` *mixed_derived* : ``public cppad_mixed`` {

.. meta::
   :keywords: mixed_object

.. index:: mixed_object

.. _derived_ctor@mixed_object:

mixed_object
************
This is the derived class object that is constructed by the syntax above.

.. meta::
   :keywords: cppad_mixed

.. index:: cppad_mixed

.. _derived_ctor@cppad_mixed:

cppad_mixed
***********
The derived class constructor must call its base class constructor as follows:

| |tab| ``cppad_mixed`` (
| |tab| |tab| *n_fixed* , *n_random* , *quasi_fixed* , *bool_sparsity* , *A_rcv*
| |tab| )

The arguments *quasi_fixed* , *bool_sparsity* , *A_rcv*
are optional; see default values in prototype above.

.. meta::
   :keywords: n_fixed

.. index:: n_fixed

.. _derived_ctor@n_fixed:

n_fixed
*******
This is the number of
:ref:`fixed effects<problem@Notation@Fixed Effects, theta>` in the model.

.. meta::
   :keywords: n_random

.. index:: n_random

.. _derived_ctor@n_random:

n_random
********
This is the number of
:ref:`random effects<problem@Notation@Random Effects, u>` in the model.
In the case where there are
:ref:`problem@Maximum Likelihood@No Random Effects` ,
*n_random*  = 0 .

.. meta::
   :keywords: quasi_fixed

.. index:: quasi_fixed

.. _derived_ctor@quasi_fixed:

quasi_fixed
***********

.. meta::
   :keywords: true

.. index:: true

.. _derived_ctor@quasi_fixed@true:

true
====
If *quasi_fixed* is true,
a quasi-Newton approximation for the Hessian of the fixed effects objective
:ref:`L(theta)<theory@Objective@Fixed Effects Objective, L(theta)>`
is used during the optimization of the fixed effects.
This is more robust when :ref:`optimize_fixed@fixed_in`
is far away from a reasonable value and might lead to the
Hessian w.r.t. the random effects not being positive definite.
If *quasi_fixed* is true,
some initialization is skipped during :ref:`initialize-name` .
This initialization is needed, and hence computed if
the and when the :ref:`information matrix<information_mat-name>` is computed.

.. meta::
   :keywords: false

.. index:: false

.. _derived_ctor@quasi_fixed@false:

false
=====
If *quasi_fixed* is false,
the Hessian of the fixed effects objective is computed using the
approximate Laplace objective
:ref:`H(beta, theta, u)<theory@Approximate Laplace Objective, H(beta, theta, u)>` .
The extra routines for initializing the second order accurate
approximation for the Laplace objective ``init_laplace_obj_fun`` ,
and ``init_laplace_obj_hes`` are used to initialize the
Hessian of the fixed effects objective.

.. meta::
   :keywords: bool_sparsity

.. index:: bool_sparsity

.. _derived_ctor@bool_sparsity:

bool_sparsity
*************
If *bool_sparsity* is true, where possible
boolean sparsity patterns are used for this computation,
otherwise set sparsity patterns are used.
This should only affect to amount of time and memory used for the
computations.

.. meta::
   :keywords: a_rcv

.. index:: a_rcv

.. _derived_ctor@A_rcv:

A_rcv
*****
This is a
:ref:`sparse_mat_info@Notation@Sparse Matrix`
representation of the
:ref:`random constraint matrix<problem@Notation@Random Constraint Matrix, A>`
:math:`A`.
If *random_vec* . ``size`` () is zero,
there are no constraint equations and *A_rcv* . ``nr`` () == 0
(this is the case for the default value of this argument).
Otherwise, *A_rcv* . ``nc`` () must be equal to *n_random*
and *A_rcv* . ``nr`` () is the number of constraints.

.. meta::
   :keywords: trace_init

.. index:: trace_init

.. _derived_ctor@trace_init:

trace_init
**********
If true, trace the initialization of cppad_mixed data structures on
standard output. This can be useful for large problems where the initialization
takes a significant amount of time.
For an example see
:ref:`hes_fixed_obj.cpp@trace_init` .

...
***
Other arguments to the derived class constructor
(that are not used by the base class constructor).
The other arguments need not appear at the end of the derived
class constructor (as in the syntax above).

.. meta::
   :keywords: cppad, errorhandler

.. index:: cppad, errorhandler

.. _derived_ctor@CppAD ErrorHandler:

CppAD ErrorHandler
******************
If a CppAD error occurs, its
`ErrorHandler <http://www.coin-or.org/CppAD/Doc/errorhandler.htm>`_
is used to map it to either a
:ref:`base_class@User Defined Functions@fatal_error`
or
:ref:`base_class@User Defined Functions@warning` .

.. meta::
   :keywords: example

.. index:: example

.. _derived_ctor@Example:

Example
*******
The file :ref:`derived_ctor.cpp-name` contains an example and test
that uses this derived class.
It returns true for success and false for failure.

.. toctree::
   :maxdepth: 1
   :hidden:

   derived_ctor.cpp
