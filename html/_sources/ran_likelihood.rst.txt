.. include:: xrst_preamble.rst

.. _ran_likelihood-name:

!!!!!!!!!!!!!!
ran_likelihood
!!!!!!!!!!!!!!

xrst input file: ``src/ran_likelihood.xrst``

.. meta::
   :keywords: ran_likelihood, user, defined, random, likelihood, function

.. index:: ran_likelihood, user, defined, random, likelihood, function

.. _ran_likelihood-title:

User Defined Random Likelihood Function
#######################################

.. meta::
   :keywords: syntax

.. index:: syntax

.. _ran_likelihood@Syntax:

Syntax
******
*vec* = *mixed_object* . ``ran_likelihood`` ( *fixed_vec* , *random_vec* )

.. meta::
   :keywords: mixed_object

.. index:: mixed_object

.. _ran_likelihood@mixed_object:

mixed_object
************
We use :ref:`derived_ctor@mixed_object`
to denote an object of a class that is
derived from the ``cppad_mixed`` base class.

.. meta::
   :keywords: virtual, function

.. index:: virtual, function

.. _ran_likelihood@Virtual Function:

Virtual Function
****************
The following virtual function may be implemented
in the derived class:

| |tab| ``virtual CppAD::vector<a1_double> ran_likelihood`` (
| |tab| |tab| ``const CppAD::vector<a1_double>&`` *fixed_vec*   ,
| |tab| |tab| ``const CppAD::vector<a1_double>&`` *random_vec*
| |tab| )

.. meta::
   :keywords: fixed_vec

.. index:: fixed_vec

.. _ran_likelihood@fixed_vec:

fixed_vec
*********
This argument has prototype

   ``const CppAD::vector<a1_double>&`` *fixed_vec*

It contains a value for the
:ref:`fixed effects<problem@Notation@Fixed Effects, theta>` vector.

.. meta::
   :keywords: random_vec

.. index:: random_vec

.. _ran_likelihood@random_vec:

random_vec
**********
This argument has prototype

   ``const CppAD::vector<a1_double>&`` *random_vec*

It contains a value for the
:ref:`random effects<problem@Notation@Random Effects, u>` vector.

.. meta::
   :keywords: vec

.. index:: vec

.. _ran_likelihood@vec:

vec
***
This result has prototype

   ``CppAD::vector<a1_double>`` *vec*

It is a
:ref:`problem@Negative Log-Density Vector`
corresponding to the random likelihood
:ref:`f(theta, u)<theory@Random Likelihood, f(theta, u)>` where

.. math::

   f( \theta , u) = - \log [ \B{p}( y | \theta, u) \B{p} ( u | \theta ) ]

The Laplace approximation only makes sense if this function is smooth; i.e,

   *vec* . ``size`` () == 1

.. meta::
   :keywords: constant

.. index:: constant

.. _ran_likelihood@vec@constant:

constant
========
Adding or subtracting a constant to *vec* [0] ,
that does not depend on the fixed effects :math:`\theta`
or the random effects :math:`u`,
does not affect the optimal estimates for the fixed and random effects.

.. meta::
   :keywords: default

.. index:: default

.. _ran_likelihood@vec@Default:

Default
=======
The base class definition (default) for ``ran_likelihood``
returns an empty vector;
i.e., *vec* . ``size`` () == 0 .
This corresponds to the case where none of the data depends on the
random effects; i.e., the data vector
:ref:`y<problem@Notation@Data, y, z>` is empty.
In this case there random effects vector should also be empty.

.. meta::
   :keywords: example

.. index:: example

.. _ran_likelihood@Example:

Example
*******
The file :ref:`ran_likelihood.cpp-name` contains an example
of defining this virtual function.

.. toctree::
   :maxdepth: 1
   :hidden:

   ran_likelihood.cpp
